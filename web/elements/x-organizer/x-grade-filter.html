<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../data-model/data-model.html">
<link rel="import" href="../x-grade-icon/x-grade-icon.html">
<link rel="import" href="x-multi-select-behaviour.html">

<dom-module id="x-grade-filter">
  <style>
    :host {
      @apply(--layout-vertical);
      @apply(--layout-wrap);
    }
    .item {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      height: 48px;
      border-radius: 3px;
      transition: background 0.2s;
    }
    .item:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    .item, .item > * {
      cursor: pointer;
    }
    .item[unselected] > * {
      opacity: 0.3;
    }
    .item[unselected] label {
      text-decoration: line-through;
    }
    x-grade-icon {
      transition: opacity 0.2s;
      margin: 0 24px 0 16px;
    }
    label {
      @apply(--layout-flex);
      font-size: 14px;
    }
  </style>

  <template>
    <template
      id="list"
      is="dom-repeat"
      items="[[options]]">
      <div
        class="item"
        unselected$="[[!item.selected]]"
        on-tap="_handleTap"
        on-dblclick="_handleDoubleTap">
        <x-grade-icon
          grade="[[item.value]]"
          size="3">
        </x-grade-icon>
        <label>[[_computeLabel(item.value)]]</label>
      </div>
    </template>
  </template>

  <script>
    Polymer({
      is: "x-grade-filter",

      behaviors: [
        App.MultiSelectBehaviour
      ],

      ready: function () {
        this.set("items", [
          new Grade(1),
          new Grade(2),
          new Grade(3),
          new Grade(4),
          new Grade(5),
          null
        ]);
        this.selectAll();
      },

      _computeLabel: function (item) {
        if (item instanceof Grade) {
          return [
            "Sehr gut",
            "Gut",
            "Befriedigend",
            "Gen\u00fcgend",
            "Nicht gen\u00fcgend"
          ][item.value - 1];
        } else {
          return "Keine Teilnahme";
        }
      },

      _handleTap: function (event) {
        this.toggle(event.model.item.value);
      },

      _handleDoubleTap: function (event) {
        this.selected = [event.model.item.value];
      }
    });
  </script>
</dom-module>
