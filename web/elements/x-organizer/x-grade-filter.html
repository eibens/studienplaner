<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../data-model/data-model.html">
<link rel="import" href="../x-grade-icon/x-grade-icon.html">
<link rel="import" href="x-multi-select-behaviour.html">
<link rel="import" href="x-organizer-item.html">

<dom-module id="x-grade-filter">
  <style>
    :host {
      @apply(--layout-vertical);
    }
    x-organizer-item[unselected] > * {
      opacity: 0.3;
    }
    x-organizer-item[unselected] x-grade-icon {
      text-decoration: line-through;
    }
    x-grade-icon {
      transition: opacity 0.2s;
    }
  </style>

  <template>
    <template
      id="list"
      is="dom-repeat"
      items="[[options]]">
      <x-organizer-item
        text="[[_computeLabel(item.value)]]"
        on-tap="_handleTap"
        on-dblclick="_handleDoubleTap"
        unselected$="[[!item.selected]]">
        <x-grade-icon
          class="icon"
          grade="[[item.value]]"
          size="3">
        </x-grade-icon>
      </x-organizer-item>
    </template>
  </template>

  <script>
    Polymer({
      is: "x-grade-filter",

      behaviors: [
        App.MultiSelectBehaviour
      ],

      ready: function () {
        this.set("items", [
          new Grade(1),
          new Grade(2),
          new Grade(3),
          new Grade(4),
          new Grade(5),
          null
        ]);
        this.selectAll();
      },

      _computeLabel: function (item) {
        if (item instanceof Grade) {
          return [
            "Sehr gut",
            "Gut",
            "Befriedigend",
            "Gen\u00fcgend",
            "Nicht gen\u00fcgend"
          ][item.value - 1];
        } else {
          return "Keine Teilnahme";
        }
      },

      _handleTap: function (event) {
        this.toggle(event.model.item.value);
      },

      _handleDoubleTap: function (event) {
        this.selected = [event.model.item.value];
      }
    });
  </script>
</dom-module>
