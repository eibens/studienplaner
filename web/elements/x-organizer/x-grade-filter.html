<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../data-model/data-model.html">
<link rel="import" href="../x-grade-icon.html">
<link rel="import" href="x-multi-select-behaviour.html">

<dom-module id="x-grade-filter">
  <style>
    :host {
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
    }
    x-grade-icon {
      transition: opacity 0.2s;
      margin: 0 8px 8px 0;
      opacity: 0.3;
    }
    [selected] {
      opacity: 1.0;
    }
  </style>

  <template>
    <template
      id="list"
      is="dom-repeat"
      items="[[options]]">
      <x-grade-icon
        grade="[[item.value]]"
        size="3"
        interactive
        selected$="[[item.selected]]"
        on-tap="_handleTap"
        on-dblclick="_handleDoubleTap">
      </x-grade-icon>
    </template>
  </template>

  <script>
    Polymer({
      is: "x-grade-filter",

      behaviors: [
        App.MultiSelectBehaviour
      ],

      ready: function () {
        this.set("items", [
          null,
          new Grade(1),
          new Grade(2),
          new Grade(3),
          new Grade(4),
          new Grade(5)
        ]);
        this.selectAll();
      },

      _handleTap: function (event) {
        this.toggle(event.model.item.value);
        if (this.selected.length == 0) {
          this.selectAll();
        }
      },

      _handleDoubleTap: function (event) {
        this.deselectAll();
        this.select(event.model.item.value);
      }
    });
  </script>
</dom-module>
