<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/paper-styles/paper-styles.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="x-course-filter/x-course-filter-parameter-behavior.html">
<link rel="import" href="x-course-list-item.html">
<link rel="import" href="x-grade-chart.html">
<link rel="import" href="x-stats/x-stats.html">
<link rel="import" href="x-semester-picker.html">
<link rel="import" href="x-course-list/x-course-list.html">

<dom-module id="x-browser">
  <style>
    :host {
      @apply(--layout-vertical);
    }
    header {
      height: 40px;
      width: 100%;
    }
    .notice {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      background: var(--light-primary-color);
      height: 64px;
      @apply(--paper-font-subhead);
      padding: 0 8px;
      color: var(--default-primary-color);
    }
    .notice > * {
      margin: 0 8px;
    }
    .notice p {
      @apply(--layout-flex);
    }

    main {
      @apply(--layout-vertical);
      width: 100%;
      padding-bottom: 8px;
    }
    .placeholder {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
      margin: 2em;
    }
    x-stats {
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      margin-bottom: 8px;
    }

    @media (min-width: 768px) {
      main {
        @apply(--shadow-elevation-3dp);
        background: var(--primary-background-color);
      }
    }
  </style>

  <template>
    <header
      hidden$="[[_isEmptyValue(semester)]]">
      <x-semester-picker
        value="{{semester}}">
      </x-semester-picker>
    </header>
    <main>
      <div
        class="notice"
        hidden$="[[_filterCleared]]">
        <paper-icon-button
          icon="close"
          on-tap="_resetFilter">
        </paper-icon-button>
        <p>Filter sind aktiv</p>
      </div>
      <x-stats
        courses="[[result]]"
        mode="{{_sortMode}}">
      </x-stats>
      <x-course-list
        courses="[[courses]]"
        result="{{result}}"
        filter-cleared="{{_filterCleared}}"
        sort-mode="[[_sortMode]]"
        query="{{query}}"
        semester="{{semester}}"
        allowed-types="{{allowedTypes}}"
        allowed-grades="{{allowedGrades}}"
        required-tags="{{requiredTags}}"
        forbidden-tags="{{forbiddenTags}}">
      </x-course-list>
    </main>
    <div
      class="placeholder"
      hidden$="[[!_empty]]">
      Keine Kurse gefunden
    </div>
  </template>

  <script>
    Polymer({
      is: "x-browser",

      behaviors: [
        App.CourseFilterParameterBehavior
      ],

      properties: {
        courses: {
          type: Array,
          value: []
        },

        _empty: {
          type: Boolean,
          computed: "_computeEmpty(result)"
        }
      },

      _resetFilter: function () {
        this.fire("reset-filter");
      },

      _computeEmpty: function () {
        return this.result.length === 0;
      },

      _isEmptyValue: function (value) {
        return !value;
      }
    });
  </script>
</dom-module>
