<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="x-course-sort">
  <script>
    Polymer({
      is: "x-course-sort",

      properties: {

        /**
         * Value indicating the main sorting attribute.
         *
         * Per default it sorts by title, type. There are two other modes:
         *
         * - `credits` sorts by credits, grade, title, type
         * - `grade` sorts by grade, credits, title, type
         */
        mode: {
          type: String
        }
      },

      compare: function (a, b) {
        switch (this.mode) {
          case "credits":
            return this._compare(a, b, [
              this._compareCredits,
              this._compareGrade,
              this._compareTitle,
              this._compareType
            ]);
          case "grade":
            return this._compare(a, b, [
              this._compareGrade,
              this._compareCredits,
              this._compareTitle,
              this._compareType
            ]);
          default:
            return this._compare(a, b, [
              this._compareTitle,
              this._compareType
            ]);
        }
      },

      _compareTitle: function (a, b) {
        return a.title.localeCompare(b.title);
      },

      _compareType: function (a, b) {
        return a.type.localeCompare(b.type);
      },

      _compareGrade: function (a, b) {
        if (a.grade == b.grade) return 0;
        if (a.grade == "none") return 1;
        if (b.grade == "none") return -1;
        if (!a.grade) return 1;
        if (!b.grade) return -1;
        return a.grade.toString().localeCompare(b.grade.toString());
      },

      _compareCredits: function (a, b) {
        return b.credits - a.credits;
      },

      _compare: function (a, b, comparators) {
        for (var i = 0; i < comparators.length; i++) {
          var delta = comparators[i](a, b);
          if (delta) {
            return delta;
          }
        }
        return 0;
      }
    });
  </script>
</dom-module>
