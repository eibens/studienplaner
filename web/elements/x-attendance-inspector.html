<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="x-course-avatar.html">
<link rel="import" href="x-grade-icon.html">
<link rel="import" href="x-grade-picker.html">
<link rel="import" href="x-inspector.html">
<link rel="import" href="x-placeholder.html">
<link rel="import" href="x-semester-picker.html">

<dom-module id="x-attendance-inspector">
  <style>
    :host {
      @apply(--layout-vertical);
      background: white;
    }
    paper-icon-button {
      --paper-icon-button-ink-color: white;
    }
    nav .back {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
      @apply(--layout-self-stretch);
      @apply(--layout-flex);
      position: relative;
      cursor: pointer;
      padding: 0 12px;
    }
    nav .back .title {
      @apply(--layout-flex);
      font-size: 14px;
      font-weight: 100;
    }
    nav .back .title div {
      overflow-x: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    nav .back .title [placeholder] {
      opacity: 0.5;
      font-style: italic;
    }
    nav .back x-course-avatar {
      width: 32px;
      height: 32px;
      font-size: 14px;
      margin-right: 12px;
    }
    nav paper-icon-button {
      margin: 0 8px;
    }
    header {
      font-weight: 100;
    }
    header x-grade-icon {
      border-color: rgba(255, 255, 255, 0.1);
    }
    header .year {
      margin-top: 16px;
      font-size: 20px;
    }
    header .season {
      opacity: 0.5;
      font-size: 15px;
    }
    main > * {
      height: 64px;
    }
  </style>

  <template>
    <x-inspector>
      <nav>
        <div
          class="back"
          on-tap="_handleClose">
          <paper-ripple></paper-ripple>
          <x-course-avatar
            label="[[attendance.course.type]]">
          </x-course-avatar>
          <x-placeholder
            class="title"
            value="[[attendance.course.title]]">
            <div placeholder>Unbenannt</div>
            <div title$="[[attendance.course.title]]">[[attendance.course.title]]</div>
          </x-placeholder>
        </div>
        <paper-icon-button
          class="delete"
          icon="delete"
          on-tap="_handleDelete">
        </paper-icon-button>
      </nav>

      <header>
        <x-grade-icon
          grade="[[attendance.grade]]"
          size="9">
        </x-grade-icon>
        <div class="year">[[attendance.semester.year]]</div>
        <div class="season">[[_formatSeason(attendance.semester.isWinter)]]</div>
      </header>

      <main>
        <x-grade-picker
          value="{{attendance.grade}}">
        </x-grade-picker>
        <x-semester-picker
          value="{{attendance.semester}}">
        </x-semester-picker>
      </main>
    </x-inspector>
  </template>

  <script>
    Polymer({
      is: "x-attendance-inspector",

      properties: {
        attendance: {
          type: Object,
          value: null
        }
      },

      _formatSeason: function (isWinter) {
        return isWinter ? "Winter" : "Sommer";
      },

      _handleClose: function () {
        this.fire("select-attendance", { data: null });
      },
      _handleDelete: function () {
        this.fire("delete-attendance", { data: this.attendance });
      }
    });
  </script>
</dom-module>
