<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">

<dom-module id="x-grade-icon">
  <style>
    :host {
      @apply(--layout);
      @apply(--layout-center-center);
      position: relative;
      color: white;
      font-weight: 100;
      box-sizing: border-box;
    }
    :host([empty]) {
      border: 3px solid rgba(0, 0, 0, 0.2);
    }
    paper-ripple {
      visibility: hidden;
    }
    :host([interactive]) paper-ripple {
      visibility: visible;
      cursor: pointer;
    }
  </style>

  <template>
    <paper-ripple></paper-ripple>
    <span>{{grade.value}}</span>
  </template>

  <script>
    Polymer({
      is: "x-grade-icon",

      properties: {
        grade: {
          type: Object,
          value: null,
          observer: "_handleGradeChanged"
        },
        size: {
          type: Number,
          value: 3,
          observer: "_handleSizeChanged"
        },
        interactive: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        empty: {
          type: Boolean,
          notify: true,
          computed: "_computeEmpty(grade)",
          reflectToAttribute: true
        },
        _label: {
          type: String,
          computed: "_computeLabel(grade)"
        }
      },

      _computeEmpty: function (grade) {
        return !grade;
      },
      _computeLabel: function (grade) {
        if (!grade) return null;
        return grade.value;
      },

      _handleGradeChanged: function (grade) {
        this.style.background = this._getColor(grade);
      },
      _handleSizeChanged: function (size) {
        this.style.borderRadius = size + "px";
        this.style.width = size * 8 + "px";
        this.style.height = size * 8 + "px";
        this.style.fontSize = size * 4 + "px";
      },

      _getColor: function (grade) {
        if (!grade) {
          return "transparent";
        }
        var colors = this._getColors();
        var index = grade.value - 1;
        return colors[index];
      },

      _getColors: function () {
        return [
          'rgb(118, 168, 63)', // 1
          'rgb(169, 197, 58)', // 2
          'rgb(213, 208, 43)', // 3
          'rgb(225, 186, 30)', // 4
          'rgb(242, 150, 75)'  // 5
        ];
      }
    });
  </script>
</dom-module>
